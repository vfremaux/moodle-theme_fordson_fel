define ("theme_fordson_fel/flex_section_control",["jquery","core/config","core/log"],function(a,b,c){var d={courseid:0,init:function init(b){this.courseid=b;a(".flexcontrol").on("click",this.togglestate);a(".section-caption").on("keydown",this.togglekeyreceiver);a(".flexsection-global-control").on("click",this.processglobal);a(".flexsections > .section > .content > .sectionname").on("click",this.proxysectionnameevent);c.debug("AMD Flex sections control initialized")},init_editing:function init_editing(b){this.courseid=b;a(".section.sub > .content > .section-content").css("display","block");a(".section.sub > .content > .section-content").css("visibility","visible");a(".section.sub > .content > .summary").css("display","block");a(".section.sub > .content > .summary").css("visibility","visible");a(".section.sub >.content > .flexsections").css("display","block");a(".section.sub >.content > .flexsections").css("visibility","visible");a(".flexcontrol").on("click",this.togglestate);a(".flexsection-global-control").on("click",this.processglobal);c.debug("AMD Flex sections control initialized v1.3")},proxysectionnameevent:function proxysectionnameevent(b){b.stopPropagation();b.preventDefault();var c=a(this).find("img");c.trigger("click")},togglestate:function togglestate(d,e){d.stopPropagation();d.preventDefault();var f=a(this);if(f.hasClass("sectioname")){var g=/sectioname-([0-9]+)-section-([0-9]+)/}else{var g=/control-([0-9]+)-section-([0-9]+)/}var h=g.exec(f.attr("id")),i=parseInt(h[1]),j=parseInt(h[2]);g=/level-([0-9]+)/;h=g.exec(f.attr("class"));var k=parseInt(h[1]);c.debug("Working for flex section "+j+" of id "+i);var l=b.wwwroot+"/theme/fordson_fel/sections/ajax/register.php?";l+="sectionid="+i;if(!e){var m=f.closest("li").parent().closest("li").attr("id");a.each(a("#"+m+" .flexcontrol.level-"+k),function(b,c){if(a(c).attr("id")!=f.attr("id")){a(c).trigger("click",!0)}})}if(a("#section-"+j).hasClass("expanded")||!0===e){a("#section-"+j).addClass("collapsed");a("#section-"+j).removeClass("expanded");c.debug("Changing section #section-title-"+j+" to false");a("#section-title-"+j).attr("aria-expanded","false");a("#section-"+j+" > .content > .section-content").addClass("collpased");a("#section-"+j+" > .content > .section-content").removeClass("expanded");e=1}else{a("#section-"+j).addClass("expanded");a("#section-"+j).removeClass("collapsed");c.debug("Changing section #section-title-"+j+" to true");a("#section-title-"+j).attr("aria-expanded","true");a("#section-"+j+" > .content > .section-content").addClass("expanded");a("#section-"+j+" > .content > .section-content").removeClass("collapsed");e=0;var n=f.offset();n.top-=70;a("html, body").animate({scrollTop:n.top,scrollLeft:0})}l+="&hide="+e;a.get(l,function(){});return!1},processglobal:function processglobal(c){c.stopPropagation();c.preventDefault();var e=a(this),f=/flexsections-control-([a-z]+)/.exec(e.attr("id")),g=f[1],h=b.wwwroot+"/theme/fordson_fel/sections/ajax/register.php?";h+="id="+d.courseid;h+="&what="+g;switch(g){case"collapseall":a(".section.sub").removeClass("expanded");a(".section.sub").addClass("collapsed");a(".section-content").addClass("collpased");a(".section-content").removeClass("expanded");a(".section-title").attr("aria-expanded","false");break;case"expandall":a(".section").removeClass("collapsed");a(".section").addClass("expanded");a(".section-content").addClass("expanded");a(".section-content").removeClass("collapsed");a(".section-title").attr("aria-expanded","true");break;case"map":a(".section").removeClass("collapsed");a(".section").addClass("expanded");a(".section-content").removeClass("expanded");a(".section-content").addClass("collapsed");a(".section-title").attr("aria-expanded","false");a(".section.isleaf").addClass("expanded");a(".section.isleaf").removeClass("collapsed");a(".section.isleaf .section-title").attr("aria-expanded","true");}a.get(h)},togglekeyreceiver:function togglekeyreceiver(b){var c=a(this);if(13==b.keyCode||32==b.keyCode){var e=c.closest("li"),f=e.attr("id").replace("section-",""),g=c.find("#section-title-"+f+" > div.flexcontrol"),h=a.proxy(d.togglestate,g);h(b)}}};return d});
//# sourceMappingURL=flex_section_control.min.js.map
